            function doPost(e) {
  try {
    // Valider que les données POST existent
    if (!e || !e.postData || !e.postData.contents) {
      throw new Error("Aucune donnée reçue");
    }
    
    var sheet = SpreadsheetApp.openById('15x7hyaKkhjXfiYi92GY5y0iAlgJhU2wtN-23Y6FH_uU').getSheets()[0];
    var data = JSON.parse(e.postData.contents);
    
    // Valider les champs requis
    if (!data.nom || !data.date) {
      throw new Error("Champs requis manquants");
    }
    
    sheet.appendRow([
      new Date(),
      data.nom || '',
      data.date || '',
      data.heureDebut || '',
      data.heureFin || '',
      data.totalHeures || '',
      data.projet || '',
      data.notes || ''
    ]);
    
    return ContentService
      .createTextOutput(JSON.stringify({
        result: "success",
        message: "Feuille de temps enregistrée avec succès"
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch(error) {
    return ContentService
      .createTextOutput(JSON.stringify({
        result: "error",
        message: error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
