<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LOISELLE - Inspection Quotidienne</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #0d1b2a, #1a2f42); padding: 15px; color: #333; }
.container { max-width: 600px; margin: auto; background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 30px rgba(0,0,0,0.3); }
.header { background: #12263a; color: white; padding: 25px; margin: -20px -20px 20px -20px; border-radius: 15px 15px 0 0; text-align: center; }
.header h1 { font-size: 2em; margin-bottom: 5px; letter-spacing: 2px; }
.header p { color: #ffc107; font-size: 0.9em; }
.section { background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 15px; }
.section h3 { color: #12263a; margin-bottom: 10px; font-size: 1.1em; }
label { display: block; font-weight: bold; margin: 10px 0 5px 0; color: #12263a; font-size: 0.9em; }
input, textarea { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; margin-bottom: 10px; }
input:focus, textarea:focus { outline: none; border-color: #28a745; }
.item { background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px; border: 2px solid #e9ecef; }
.item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.item-name { font-weight: bold; color: #333; }
.item-name small { display: block; color: #888; font-size: 0.85em; font-weight: normal; }
.buttons { display: flex; gap: 10px; }
.buttons button { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 0.9em; }
.btn-ok { background: #e9ecef; color: #666; }
.btn-ok.active { background: #28a745; color: white; box-shadow: 0 4px 10px rgba(40, 167, 69, 0.4); }
.btn-def { background: #e9ecef; color: #666; }
.btn-def.active { background: #d9534f; color: white; box-shadow: 0 4px 10px rgba(217, 83, 79, 0.4); }
.defect-zone { display: none; margin-top: 10px; padding: 10px; background: #fff5f5; border-radius: 8px; border: 2px dashed #d9534f; }
.sig-box { border: 3px dashed #ccc; border-radius: 10px; height: 150px; background: white; position: relative; cursor: crosshair; }
.sig-box canvas { width: 100%; height: 100%; }
.sig-clear { position: absolute; top: 5px; right: 5px; background: #d9534f; color: white; border: none; padding: 5px 10px; border-radius: 5px; font-size: 0.8em; cursor: pointer; }
.btn-submit { background: #ffc107; color: #12263a; width: 100%; padding: 18px; border: none; border-radius: 10px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 20px; text-transform: uppercase; }
.btn-submit:active { transform: scale(0.98); }
#result { display: none; margin-top: 20px; }
.success { background: #d4edda; border: 2px solid #28a745; padding: 20px; border-radius: 10px; color: #155724; }
.success h2 { margin-bottom: 15px; color: #28a745; }
.report { background: white; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #28a745; max-height: 400px; overflow-y: auto; }
.report pre { white-space: pre-wrap; font-size: 0.9em; line-height: 1.6; font-family: monospace; }
.action-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
.action-btns button { padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; }
.progress { background: #e9ecef; height: 8px; border-radius: 10px; overflow: hidden; margin: 10px 0; }
.progress-bar { background: #28a745; height: 100%; width: 0%; transition: width 0.3s; }
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>ğŸš› LOISELLE</h1>
<p>INSPECTION QUOTIDIENNE / DAILY INSPECTION</p>
</div>

<div id="form-section">
<div class="section">
<h3>ğŸ“‹ Informations</h3>
<label>ğŸ‘¤ EmployÃ© / Employee</label>
<input type="text" id="employe" placeholder="Nom complet" required>
<label>ğŸ”¢ Plaque / Plate</label>
<input type="text" id="plaque" placeholder="ABC-123" required>
<label>ğŸš› UnitÃ© / Unit</label>
<input type="text" id="unite" placeholder="NumÃ©ro d'unitÃ©" required>
<label>ğŸ“… Date</label>
<input type="date" id="date" required>
<label>ğŸ• Heure / Time</label>
<input type="time" id="heure" required>
<label>ğŸ“ Lieu / Location</label>
<input type="text" id="lieu" placeholder="Ville ou adresse">
</div>

<div class="section">
<h3>ğŸ” Points d'inspection</h3>
<div class="progress"><div class="progress-bar" id="progress"></div></div>
<p style="text-align: center; color: #666; font-size: 0.9em;" id="progress-text">0/8 complÃ©tÃ©s</p>
</div>

<div id="items-list"></div>

<div class="section">
<h3>ğŸ’¬ Commentaires</h3>
<textarea id="comments" rows="3" placeholder="Notes gÃ©nÃ©rales..."></textarea>
</div>

<div class="section">
<h3>âœï¸ Signature</h3>
<div class="sig-box">
<canvas id="canvas"></canvas>
<button class="sig-clear" onclick="clearSig()">Effacer</button>
</div>
</div>

<button class="btn-submit" onclick="submitForm()">ğŸš€ SOUMETTRE / SUBMIT</button>

</div>

<div id="result">
<div class="success">
<h2>âœ… INSPECTION ENREGISTRÃ‰E</h2>
<p><strong>EmployÃ©:</strong> <span id="r-emp"></span></p>
<p><strong>Plaque:</strong> <span id="r-plaque"></span></p>
<p><strong>Date:</strong> <span id="r-date"></span></p>
<p><strong>Statut:</strong> <span id="r-status"></span></p>
<div class="report"><pre id="report-text"></pre></div>
<div class="action-btns">
<button onclick="emailReport()" style="background: #007bff;">ğŸ“§ EMAIL</button>
<button onclick="copyReport()" style="background: #6c757d;">ğŸ“‹ COPIER</button>
<button onclick="downloadTXT()" style="background: #28a745;">ğŸ’¾ TXT</button>
<button onclick="location.reload()" style="background: #17a2b8;">ğŸ”„ NOUVEAU</button>
</div>
</div>
</div>
</div>

<script>
const items = [
{fr: "ğŸ’§ Niveaux & Fuites", en: "Fluids & Leaks"},
{fr: "ğŸ”§ Pneus & Boulons", en: "Tires & Bolts"},
{fr: "ğŸ›‘ Freins & Boyaux", en: "Brakes & Hoses"},
{fr: "ğŸ’¡ LumiÃ¨res & Gyrophare", en: "Lights & Beacon"},
{fr: "ğŸ¯ Direction & Suspension", en: "Steering & Suspension"},
{fr: "ğŸª Miroirs & Pare-brise", en: "Mirrors & Windshield"},
{fr: "ğŸ§¯ SÃ©curitÃ©", en: "Safety Equipment"},
{fr: "ğŸ“¦ Chargement", en: "Load Security"}
];

let inspectionData = { items: [], signature: null };

const list = document.getElementById('items-list');
items.forEach((item, i) => {
list.innerHTML += `
<div class="item">
<div class="item-header">
<div class="item-name">${item.fr}<small>${item.en}</small></div>
<div class="buttons">
<button class="btn-ok" onclick="setStatus(${i}, 'OK')">OK</button>
<button class="btn-def" onclick="setStatus(${i}, 'DEF')">DEF</button>
</div>
</div>
<div class="defect-zone" id="defect-${i}">
<label style="color: #d9534f; font-size: 0.9em;">Note du dÃ©faut:</label>
<textarea id="note-${i}" placeholder="DÃ©crivez le dÃ©faut..."></textarea>

</div>
</div>
`;
});

document.getElementById(â€˜dateâ€™).valueAsDate = new Date();
document.getElementById(â€˜heureâ€™).value = new Date().toTimeString().slice(0,5);

const canvas = document.getElementById(â€˜canvasâ€™);
const ctx = canvas.getContext(â€˜2dâ€™);
let drawing = false;
let hasSig = false;

function resizeCanvas() {
canvas.width = canvas.offsetWidth;
canvas.height = canvas.offsetHeight;
ctx.lineWidth = 2;
ctx.lineCap = â€˜roundâ€™;
ctx.strokeStyle = â€˜#000â€™;
}
window.addEventListener(â€˜loadâ€™, resizeCanvas);

canvas.addEventListener(â€˜mousedownâ€™, (e) => startDraw(e));
canvas.addEventListener(â€˜mousemoveâ€™, (e) => draw(e));
canvas.addEventListener(â€˜mouseupâ€™, stopDraw);
canvas.addEventListener(â€˜touchstartâ€™, (e) => { e.preventDefault(); startDraw(e.touches[0]); });
canvas.addEventListener(â€˜touchmoveâ€™, (e) => { e.preventDefault(); draw(e.touches[0]); });
canvas.addEventListener(â€˜touchendâ€™, stopDraw);

function startDraw(e) {
drawing = true;
hasSig = true;
const rect = canvas.getBoundingClientRect();
ctx.beginPath();
ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
}

function draw(e) {
if (!drawing) return;
const rect = canvas.getBoundingClientRect();
ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
ctx.stroke();
}

function stopDraw() { drawing = false; }

function clearSig() {
ctx.clearRect(0, 0, canvas.width, canvas.height);
hasSig = false;
}

function setStatus(index, status) {
const item = document.querySelectorAll(â€™.itemâ€™)[index];
const okBtn = item.querySelector(â€™.btn-okâ€™);
const defBtn = item.querySelector(â€™.btn-defâ€™);
const defZone = document.getElementById(`defect-${index}`);
if (status === â€˜OKâ€™) {
okBtn.classList.add(â€˜activeâ€™);
defBtn.classList.remove(â€˜activeâ€™);
defZone.style.display = â€˜noneâ€™;
inspectionData.items[index] = { status: â€˜OKâ€™, note: â€˜â€™ };
} else {
defBtn.classList.add(â€˜activeâ€™);
okBtn.classList.remove(â€˜activeâ€™);
defZone.style.display = â€˜blockâ€™;
inspectionData.items[index] = { status: â€˜DEFâ€™, note: â€˜â€™ };
}
updateProgress();
}

function updateProgress() {
const completed = inspectionData.items.filter(i => i).length;
const percent = (completed / items.length) * 100;
document.getElementById(â€˜progressâ€™).style.width = percent + â€˜%â€™;
document.getElementById(â€˜progress-textâ€™).textContent = `${completed}/${items.length} complÃ©tÃ©s`;
}

function submitForm() {
if (!document.getElementById(â€˜employeâ€™).value) { alert(â€˜âŒ Veuillez entrer le nom de l'employÃ©â€™); return; }
if (!document.getElementById(â€˜plaqueâ€™).value) { alert(â€˜âŒ Veuillez entrer la plaqueâ€™); return; }
if (inspectionData.items.length !== items.length) { alert(â€˜âŒ Veuillez cocher tous les itemsâ€™); return; }
if (!hasSig) { alert(â€˜âŒ Veuillez signerâ€™); return; }

inspectionData.items.forEach((item, i) => {
if (item.status === â€˜DEFâ€™) item.note = document.getElementById(`note-${i}`).value;
});

const data = {
employe: document.getElementById(â€˜employeâ€™).value,
plaque: document.getElementById(â€˜plaqueâ€™).value,
unite: document.getElementById(â€˜uniteâ€™).value,
date: document.getElementById(â€˜dateâ€™).value,
heure: document.getElementById(â€˜heureâ€™).value,
lieu: document.getElementById(â€˜lieuâ€™).value || â€˜Non spÃ©cifiÃ©â€™,
commentaires: document.getElementById(â€˜commentsâ€™).value,
items: inspectionData.items.map((item, i) => ({
nom: items[i].fr,
name: items[i].en,
statut: item.status,
note: item.note
}))
};

const defectCount = data.items.filter(i => i.statut === â€˜DEFâ€™).length;
const isCompliant = defectCount === 0;

let reportText = `
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
RAPPORT Dâ€™INSPECTION LOISELLE
LOISELLE INSPECTION REPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‘¤ EmployÃ©: ${data.employe}
ğŸ”¢ Plaque: ${data.plaque}
ğŸš› UnitÃ©: ${data.unite}
ğŸ“… Date: ${data.date}
ğŸ• Heure: ${data.heure}
ğŸ“ Lieu: ${data.lieu}

ğŸ“Š STATUT: ${isCompliant ? â€˜âœ… CONFORME / COMPLIANTâ€™ : â€˜âš ï¸ NON-CONFORME / NON-COMPLIANTâ€™}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
DÃ‰TAILS Dâ€™INSPECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

`;

data.items.forEach((item, i) => {
reportText += `${i+1}. ${item.nom}: ${item.statut}\n`;
if (item.statut === â€˜DEFâ€™ && item.note) reportText += `   ğŸ“ ${item.note}\n`;
});

if (data.commentaires) reportText += `\nğŸ’¬ COMMENTAIRES:\n${data.commentaires}\n`;
reportText += `\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n`;
reportText += `GÃ©nÃ©rÃ©: ${new Date().toLocaleString()}\n`;

window.currentReport = reportText;
window.currentData = data;

document.getElementById(â€˜r-empâ€™).textContent = data.employe;
document.getElementById(â€˜r-plaqueâ€™).textContent = data.plaque;
document.getElementById(â€˜r-dateâ€™).textContent = data.date;
document.getElementById(â€˜r-statusâ€™).textContent = isCompliant ? â€˜âœ… CONFORMEâ€™ : â€˜âš ï¸ NON-CONFORMEâ€™;
document.getElementById(â€˜report-textâ€™).textContent = reportText;

document.getElementById(â€˜form-sectionâ€™).style.display = â€˜noneâ€™;
document.getElementById(â€˜resultâ€™).style.display = â€˜blockâ€™;
window.scrollTo(0, 0);
}

function emailReport() {
const subject = encodeURIComponent(`Inspection LOISELLE - ${window.currentData.plaque}`);
const body = encodeURIComponent(window.currentReport);
window.location.href = `mailto:Mjacquesperrier@gmail.com?subject=${subject}&body=${body}`;
}

function copyReport() {
navigator.clipboard.writeText(window.currentReport).then(() => {
alert(â€˜âœ… Rapport copiÃ©!â€™);
}).catch(() => {
const el = document.createElement(â€˜textareaâ€™);
el.value = window.currentReport;
document.body.appendChild(el);
el.select();
document.execCommand(â€˜copyâ€™);
document.body.removeChild(el);
alert(â€˜âœ… Rapport copiÃ©!â€™);
});
}

function downloadTXT() {
const blob = new Blob([window.currentReport], { type: â€˜text/plainâ€™ });
const url = URL.createObjectURL(blob);
const a = document.createElement(â€˜aâ€™);
a.href = url;
a.download = `Inspection_LOISELLE_${window.currentData.plaque}_${window.currentData.date}.txt`;
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
URL.revokeObjectURL(url);
alert(â€˜âœ… Fichier tÃ©lÃ©chargÃ©!â€™);
}
</script>

</body>
</html>
